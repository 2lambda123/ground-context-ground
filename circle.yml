machine:
  services:
    - cassandra
    - neo4j

  java:
    version: oraclejdk8

dependencies:
  pre:
    - createdb test
    - createuser test -d -s
    - export PYTHONPATH="${PYTHONPATH}:/usr/lib/pymodules/python2.7"
    - cqlsh -e "SHOW VERSION;"
    - |-
        cqlsh -e "create keyspace test with replication = { 'class' : 'SimpleStrategy', 'replication_factor' : 1 };"
    - cd ground-core/scripts/postgres && python2.7 postgres_setup.py test test && cd ../../..
    - cd ground-core/scripts/cassandra && python2.7 cassandra_setup.py test && cd ../../..
  
  override:
    - mvn clean package -DskipTests

test:
  override:
    - mvn clean test

  post: 
    - mvn clean test jacoco:report coveralls:report -DrepoToken=$COVERALLS_TOKEN
